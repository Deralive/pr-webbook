# 全概率公式

样本空间的分割
: 对样本空间 $\Omega$ ，如果有 $n$ 个事件 $D_{1},D_{2} ,\cdots ,D_{n}$ 满足：

- 诸 $D_{i}$ 互不相容： $\forall i\neq j,D_{i}\cap D_{j}=\emptyset$ ；
- $\cup_{i=1}^{n} D_{i}=\Omega$ ；

则称 $\{D_{1},D_{2},\cdots,D_{n}\}$ 为样本空间 $\Omega$ 的一组分割。


```{prf:example}
:label: ex02-c

设样本空间为 $R$ 。设 $\mu$ 和 $\sigma>0$ 为两个已知的常数。令：

- $D_{1}=\left \{ \left | x-\mu \right | \leq \sigma \right \}$ ；
- $D_{2}=\left \{ \sigma <\left | x-\mu \right | \leq 2\sigma \right \}$ ；
- $D_{3}=\left \{ 2 \sigma <\left | x-\mu \right | \leq 3\sigma \right \}$ ；
- $D_{4}=\left \{ \left | x-\mu \right | > 3\sigma \right \}$ 。

于是， $\mathcal{D} =\left \{ D_{1} ,D_{2} ,D_{3} ,D_{4} \right \}$ 是一个分割。
```

````{prf:theorem} 全概率公式
:label: thm02-d

设 $B_{1},B_{2},\cdots,B_{n}$ 为样本空间 $\Omega$ 的一个分割，即 $B_{1},B_{2},\cdots,B_{n}$ 互不相容，且 $\cup_{i=1}^{n} B_{i}=\Omega$ 。如果 $P(B_{i})>0$ ，则对任一事件 $A$ ，有：

$$P(A)=\sum_{i=1}^{n} P(B_{i})P(A|B_{i})$$

```{dropdown} Proof

由题可知，

$$A=A\Omega =A\left(\bigcup_{i=1}^{n} B_{i} \right)=\bigcup_{i=1}^{n}\left(AB_{i} \right)$$

又因为 $B_{1},B_{2},\cdots,B_{n}$ 互不相容，所以， $AB_{1},AB_{2},\cdots,AB_{n}$ 互不相容。
由有限可加性知：

$$P(A)=P\left(\cup_{i=1}^{n}\left(AB_{i} \right)\right)=\sum_{i=1}^{n} P\left(AB_{i} \right)=\sum_{i=1}^{n}P(B_{i} )P(A|B_{i} )$$

因此，定理得证。
```
````

````{prf:example} 摸彩模型
:label: ex02-d

设在 $n$ 张彩票中有一张可中大奖，求第二个人摸出中奖彩票的概率是多少？

```{dropdown} Solution

设 $A_{i}=$ {“第 $i$ 个人摸到中奖彩票”} $,i=1,2,\cdots,n$ 。
第一个人模出中奖彩票的概率为：

$$
P(A_1) = \frac{1}{n}
$$
而其未摸出中奖彩票的概率为：

$$
P(\overline{A_{1} } )=\frac{n-1}{n}
$$

在第一个人是否模出中奖彩票的条件下，第二个人能否摸出中奖彩票 $A_{2}$ 的条件概率是不同的，即
- 如果第一个人中奖，第二个人一定不会中奖，即：

$$
P(A_{2} |A_{1} )=0
$$

- 如果第一个人未中奖，第二个人中奖的机会更大，即：

$$
P(A_{2} |\overline{A_{1} } )=\frac{1}{n-1}
$$

由全概率公式可知：

$$
P(A_{2})=P(A_{1} )P(A_{2}| A_{1} )+P(\overline{A_{1} } )P(A_{2}| \overline{A_{1}} )=\frac{1}{n} \cdot 0+\frac{n-1}{n}\cdot\frac{1}{n-1}=\frac{1}{n} 
$$
```

```{prf:remark} 
:label: remark02-c
:class: dropdown

类似地，可推导出：

$$P(A_{i})=\frac{1}{n} ,i=1,2,\cdots ,n$$

这表明：摸到中奖彩票的机会与先后次序无关。
```
````

````{prf:example} 敏感性问题调查
:label: ex02-e

敏感性问题调查是社会调查之一。常见的敏感性问题调查包括是否参加赌博？是否浏览过黄色书刊或影像？是否吸毒？是否偷税漏税？是否在考试中作弊？等。对敏感性问题的调查方案，关键要使被调查者作出真实回答优能保守个人隐私。一旦调查方案设计有误，被调查者就会拒绝配合，所得调查数据将失去真实性。经过多年研究和实践，一些心理学家和统计学家设计了一种调查方案。在这个方案中，被调查者只需要回答以下两个问题中的一个问题，而且只需要回答“是”或“否”。

- **问题 A**：你的生日是否在7月1日之前？
- **问题 B**：你是否在考试中作弊？

这个调查方案看似简单，但为了消除被调查者的顾虑，使被调查者确信其参加这次调查不会泄露个人秘密，在操作中有以下关键点：
1. 被调查者在没有旁人的情况下，独自一人在一个房间内操作呵呵回答问题；
2. 被调查者从一个罐子（罐子里只有白球和红球）里随机抽一个球，确认颜色后即放回。若抽到的是白球，则回答问题A；若抽到的是红球，则回答问题B。

被调查者无论回答问题 $A$ 或问题 $B$ ，只需要在答卷上认可的方框内搭够，然后把答卷放入一个密封的投票箱内。

设我们有 $n$ 张答卷，其中有 $k$ 张答卷回答“是”。但是我们并不知道此 $n$ 张答卷中有多少张是回答问题B的，同样无法知道 $k$ 张回答“是”的答卷中有多少张是回答问题B得。但有两个信息我们是预先知道的，即
1. 当 $n$ 较大时，任选一人的生日在 $7$ 月 $1$ 日之前的概率为 $0.5$ 。
2. 罐中红球的比率 $\pi$ 已知。

根据 $(n,k,0.5,\pi)$ 求出问题B回答“是”的比例 $p$ 。由全概率公式可知：

$$
P(\text{是}) = P(\text{白球})P(\text{是}|\text{白球}) + P(\text{红球})P(\text{是}|\text{红球})。
$$

将 $P(\text{红球}) = \pi$ ， $P(\text{白球}) = 1-\pi$ ， $P(\text{是}|\text{白球}) = 0.5$ ， $P(\text{是}|\text{红球}) = p$ 代入上式，而 $P(\text{是})$ 用频率 $k/n$ 代替，得：

$$
\frac{k}{n} = 0.5 (1-\pi) + p \pi
$$

由此得：

$$
p = \frac{k/n - 0.5(1-\pi)}{\pi}
$$
````



